<html><head>
<link rel="shortcut icon" type="image/png" href="bonjouricon.jpg" />
<title>Webjour</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
<link href="webjour.css" media="screen" rel="stylesheet" type="text/css" />
<script>

	$(document).ready(function() {
		var services = {};
		var hosts = {};
		$.ajax({
			type: 'GET',
			url: '/webjour',
			dataType: 'json',
			success: function(snapshots) {
				console.debug(snapshots);
				console.debug(snapshots.length);
				for(var i=0; i < snapshots.length; i++) {
					var snapshot = snapshots[i];
					//console.debug(snapshot.service);
					if(! services[snapshot.service]) {
						services[snapshot.service] = [];
					}
					services[snapshot.service].push(snapshot);
					if(! hosts[snapshot.host]) {
						hosts[snapshot.host] = [];
					}
					hosts[snapshot.host].push(snapshot);
				}
				for(var service in services){
					var aService = $('<p>').addClass('links');
					aService.append($('<h3>').addClass(service).text(service));
					for(var i=0; i< services[service].length; i++) {
						var host = services[service][i];
						console.debug('host', host);
						aService.append(
							$('<div>').append($('<a>').attr('href', host.scheme + '://' + host.host + ':' + host.port).text(host.name))
						);
					}
					$('#services').after(aService);
				}
				for(var host in hosts){
					$('#hosts').after($('<h3>').addClass(host).text(host));
				}
			},
		});
	});
</script>
</head><body>
<h1>WebJour</h1>

<h2 id="services">Services</h2>

<h2 id="hosts">Hosts</h2>

</body>
</html>